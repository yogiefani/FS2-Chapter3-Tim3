This file has been re-written by Rafif