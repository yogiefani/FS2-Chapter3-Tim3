This file has been rewritten by Zainal